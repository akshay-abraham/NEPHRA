# NEPHRA ‚Äî Smart Hydration System

---

## üöÄ Quick Links

* üì∑ [Blender Render (Bottle Design)](./assets/render_bottle.png)
* üîß [Schematic Diagram](./assets/schematic.png)
* üß™ [Copper Tape Sensor, Prototype Image](./assets/copper_sensor.png)
* üì± [App Walkthrough Video](./assets/app_demo.mp4)
* üåê [Open the NEPHRA App (Demo)](https://9000-firebase-studio-1754815665125.cluster-ikxjzjhlifcwuroomfkjrx437g.cloudworkstations.dev)

> ‚ö†Ô∏è *Note: The app is self-hosted. Please contact us at **+91-99461-41445** to reactivate hosting before access.*

---

## üìë Table of Contents

1. [Project Overview](#-project-overview)
2. [User Experience](#-user-experience)
3. [System Architecture and Hardware](#-system-architecture-and-hardware)
4. [App & AI System](#-app--ai-system)
5. [Gamification: The Psychology of Play](#-gamification-the-psychology-of-play)
6. [AI Coach: Science Behind Personalization](#-ai-coach-science-behind-personalization)
7. [Data & Privacy](#-data--privacy)
8. [Credits](#-credits)

---

# üåç Project Overview

Water is the simplest nutrient ‚Äî yet one of the most neglected. Across schools, workplaces, and homes, people unconsciously spend hours without hydration. The result is *mild dehydration*, which causes fatigue, poor concentration, and reduced productivity.

The **problem set** given to us was:

> *‚ÄúDesign a simple, engaging solution that encourages students to drink water regularly in schools.‚Äù*

But hydration is not only a problem for children. It affects **all age groups** and contexts:

* **School-age students** ‚Üí forget to drink due to routines and distractions.
* **Elderly people** ‚Üí reduced thirst perception leads to frequent dehydration.
* **Menstruating individuals** ‚Üí hydration requirements fluctuate across cycles.
* **Athletes & outdoor workers** ‚Üí increased water needs due to activity and environment.

**NEPHRA** was built as a solution that is simple, universal, and scalable ‚Äî a smart water bottle system that makes hydration *visible, engaging, and personalized*.

---

# üë©‚Äçüéì User Experience

* **Morning Sync (Before School)**

  * The student opens the NEPHRA companion app.
  * The app uploads yesterday‚Äôs hydration history and **ambient temperature logs**.
  * The AI calculates today‚Äôs hydration plan using:

    * **Age, gender, body weight**
    * **Ambient temperature forecast**
    * **Special conditions** (e.g., menstruation, illness, sports activity)
    * **Personal preferences** (custom instructions set by user/guardian)
  * The personalized daily goal (e.g., 2.1 L) and in-bottle alert timings are sent to the bottle.

---

* **During Classes**

  * The LED ring on the cap provides subtle, non-distracting reminders:

    * Smooth **orange pulse** ‚Üí ‚Äútime to sip.‚Äù
    * **Goal progress animation** ‚Üí fills around the ring as the student drinks.
  * The MPU6050 detects tilt events. If water is consumed, the copper tape sensor logs the change in level.
  * **Spill detection**: Sudden tilt + rapid level drop without pause ‚Üí AI marks it as a spill and discards it from progress.

---

* **Break Times**

  * The student drinks water. Each sip is logged and stored locally on the ESP32.
  * If offline (no phone nearby), the bottle continues logging with the last synced plan.
  * If online, live data is transmitted to the app, updating the **timeline graph** in real time.

---

* **After Lunch**

  * Hydration needs change with meals and temperature.
  * If the classroom is warmer than usual, the AI adjusts the afternoon reminder frequency.
  * During menstruation days, hydration plans include slightly higher intake, spread across intervals to prevent bloating.

---

* **End of School Day**

  * The student‚Äôs app shows:

    * **Daily progress ring** (percentage of goal completed)
    * **Timeline graph** of every sip event
    * **Leaderboard position** (demo gamification for group motivation)
  * The app syncs all raw + event data to the cloud.

---

* **Evening at Home**

  * Parents or guardians can review hydration history for accountability.
  * AI refines long-term patterns by analyzing:

    * Historical intake data
    * Temperature trends
    * Special health inputs (e.g., menstruation, illness, sports days)

---

### **Key UX Principles**

1. **Non-intrusive reminders** ‚Üí LED animations replace loud alerts.
2. **Gamified progress** ‚Üí goal rings and leaderboard encourage consistency.
3. **AI-driven personalization** ‚Üí hydration plans adapt daily, unique to each student.
4. **Error handling** ‚Üí spill detection ensures only real drinking events are counted.
5. **Universal design** ‚Üí equally usable by children, elderly, or individuals with special hydration needs.


# ‚öôÔ∏è System Architecture and Hardware


## **1. Core Hardware Components**

* **ESP32 (Controller)**

  * Dual-core MCU with Wi-Fi + Bluetooth.
  * Responsible for:

    * Data acquisition (copper tape sensor, MPU6050).
    * Event classification (drink, refill, idle, spill).
    * Output control (LED strip animations).
    * Communication with mobile app (Bluetooth).

* **custom Copper Tape Water Level Sensor**

  * Vertical ribbon with **15 parallel copper strips**, each representing \~50 mL increment.
  * Back side epoxy-sealed, front side faces water.
  * Works as capacitive touch-like contacts:

    * Water conducts charge to energize the connected level.
    * The ESP32 detects which strips are ‚Äúactive,‚Äù indicating water level.

* **MPU6050 (Accelerometer + Gyroscope)**

  * Detects tilt and motion.
  * Provides data to distinguish:

    * **Drinking event** ‚Üí Tilt + gradual water decrease.
    * **Refill event** ‚Üí Rapid water increase.
    * **Spill event** ‚Üí Sudden tilt + rapid water drop.
    * **Idle event** ‚Üí No tilt, no water change.

* **LED Strip (WS2812B, Ring Format)**

  * Circular LED ring mounted at cap edge.
  * Provides multiple animated feedback views (2‚Äì3 modes).
  * Default: Deep orange progress ring, filling as daily goal progresses.

* **Battery & Power System**

  * Rechargeable Li-ion cell.
  * TP4056/TP6050 USB-C charging module.
  * Boost converter for regulated 5V (if required).
  * Power safety: ESP32 logic cuts sensing circuit when drinking is detected (MOSFET-controlled).

---
## **2. ESP32 Event Logic Flow**

The ESP32 continuously fuses **water level data** with **motion data** to classify states:

1. **Idle**

   * Water level constant.
   * No significant tilt detected.
   * ESP32 logs "idle" state.
   * No LED changes.

2. **Drinking**

   * Tilt detected (30‚Äì90¬∞).
   * Water level decreases gradually in sync with tilt.
   * ESP32 logs "drink event" with timestamp + volume consumed.
   * LED strip: Smooth animated pulse ‚Üí progress update.

3. **Refill**

   * Sudden increase in water level detected (‚â•100 mL within seconds).
   * ESP32 logs "refill event."
   * LED strip: Blue swirl animation for refill confirmation.

4. **Spill**

   * Rapid tilt detected (jerk motion).
   * Sudden sharp drop in water level without pause.
   * ESP32 logs "spill event" (excluded from consumption totals).
   * LED strip: Quick red flash.

---

## **3. LED Strip Views**

NEPHRA uses the LED strip not only for reminders but also as a **dynamic visualization tool**:

* **Default View ‚Äî Goal Progress Ring**

  * Orange arc fills progressively as user approaches daily hydration goal.

* **Event Feedback View (Activated Temporarily)**

  * Drinking: Orange pulse glow.
  * Refill: Blue swirl effect.
  * Spill: Red flash.
  * Automatically reverts to Default View after a few seconds.

* **Secondary Mode ‚Äî Motivational Animations**

  * Example: At 50% goal ‚Üí Green spark animation.
  * At 100% ‚Üí Multicolor celebration burst.

---

## **4. Data Handling on ESP32**

* **Offline Mode**

  * Stores all raw sensor + event data in local buffer.
  * Executes last synced AI-generated hydration plan (daily goal + alert timings).
  * Provides LED-based reminders independent of app connection.

* **Connected Mode**

  * Sends:

    * Live raw MPU + water sensor data.
    * Event logs with timestamps.
    * Current water percentage.
  * Receives from app:

    * AI-calculated daily goal.
    * In-bottle alert timings.
  * Syncs stored offline data to cloud via app.

---


# üì± App & AI System

The app is organized into **four elegant panes**‚Äîeach answering a fundamental user question:

### 1. Dashboard (The Present)

*‚ÄúHow am I doing right now?‚Äù*

* **Progress Ring** ‚Üí central, animated, deeply satisfying visual of goal completion.
* **AI Motivational Coach** ‚Üí witty encouragements to sustain effort.
* **Quick Stats** ‚Üí streaks, bottle level, ambient temp.
* **Smart Tip of the Day** ‚Üí 1 AI-driven, actionable insight.

### 2. Timeline (The Past)

*‚ÄúWhat have I done so far?‚Äù*

* Event log of every sip, refill, spill, or achievement.
* Daily & weekly navigation for habit awareness.

### 3. Leaderboard (The Social Loop)

*‚ÄúWhere do I stand among others?‚Äù*

* Ranks and Drops (in-game currency).
* Famous names & playful Easter eggs for delight.
* School/class-level leaderboards for community motivation.

### 4. Profile (Identity & Growth)

*‚ÄúWho am I and how can I improve?‚Äù*

* Core stats: Level, Rank, Streak.
* **AI Control Panel:** update weight, health status, special notes.
* **Dynamic AI Goal Plan** with instant recalibration.
* **Achievements (Trophy Case):** all milestones in one expandable section.
* **Developer Zone:** philosophy behind gamification + live simulation view.

---



# üéÆ Gamification: The Psychology of Play

Humans are wired to respond to **progress, rewards, and social recognition**. NEPHRA transforms hydration into a meaningful game:

* **XP & Levels:** Every sip earns points. Reaching milestones unlocks new titles‚Äî‚ÄúTrainee,‚Äù ‚ÄúAqua-Knight,‚Äù and beyond. This taps into the **progression loop** of gaming psychology.
* **Streaks:** Missing a day feels like ‚Äúbreaking the chain.‚Äù This exploits **loss aversion bias**‚Äîa powerful motivator that keeps students engaged daily.
* **Leaderboards:** Healthy competition with classmates (and fun Easter eggs like Alan Turing or Duo Owl) motivates through **social proof** and **status signaling**.
* **Achievements:** Collectible badges (‚ÄúFirst Sip,‚Äù ‚ÄúHydro Hero,‚Äù ‚ÄúStreak Master‚Äù) appeal to the **collector mindset**, offering long-term pride.

---
# üß† AI Coach: Science Behind Personalization
The AI system isn‚Äôt guessing‚Äîit is built on **hydration science and behavioral data**.
Using **Google Gemini**, NEPHRA‚Äôs AI considers:

* **User profile:** Age, weight, gender, menstrual cycle notes, exercise, and health status.
* **Bottle & environment data:** Live water levels, tilt/drink detection, ambient temperature.
* **Long-term patterns:** Your drinking frequency, times you forget, seasonal changes, and even spill detection.
* **Custom conditions:** e.g., fever, sports day, menstruation.

From these inputs, the AI generates:

* A **dynamic daily water goal** tailored to the user‚Äôs physiology and context.
* **Optimized reminder intervals** that *don‚Äôt nag* but gently encourage at the right moment.
* **Smart insights:** e.g., *‚ÄúYou hydrate well in mornings, but often miss post-lunch. Let‚Äôs set a 2 PM reminder.‚Äù*

This isn‚Äôt ‚Äú8 glasses for everyone.‚Äù It‚Äôs **precision hydration**.

---



# üîí Data & Privacy

* All personal data is stored **locally** on the device.  
* The AI plan is computed **client-side with Gemini** ‚Äî no permanent cloud storage.  
* Offline-first design ensures reliability in schools and low-connectivity environments.  

---

# üôå Credits

**Made by [Aletheion Labs](https://linktr.ee/aletheion)**  

* **Akshay K Rooben Abraham**  
* **Adwaith Krishna U S**

**Mentorship & Guidance**  
* ATL Mentor ‚Äî *Mr. Rohan Abraham*  
* Guidance on hardware theory-to-practice ‚Äî *Mr. Das*  

**Medical Advice**  
* *Mrs. Lally Abraham*, Pediatrician, General Hospital Kottayam  

**Other Contributors**  
* Hrishikesh Chakyar ‚Äî *custom instruction in app idea*  
* Arjun Ashok ‚Äî *ambient temperature integration idea*  
* Nandana Baburaj ‚Äî *prototype support (bottle for Prototype 1)*  

---